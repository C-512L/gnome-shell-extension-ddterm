[tox]
skipsdist = true
envlist = py3

[testenv]
deps = -r requirements.txt

commands = python -m pytest -c {toxinidir}/pytest.ini --html=report.html {posargs: -n auto --screenshot-failing-only}

suicide_timeout = 10
interrupt_timeout = 10
terminate_timeout = 10

[testenv:pip-compile]
deps = pip-tools
changedir = {toxinidir}/requirements
commands =
    pip-compile --allow-unsafe --resolver=backtracking {posargs} pypi.in
    pip-compile --allow-unsafe --resolver=backtracking {posargs} podman-compose.in
    pip-compile --allow-unsafe --resolver=backtracking {posargs} lint.in

[testenv:podman-compose]
deps = -r requirements/podman-compose.txt
commands = podman-compose {posargs}

[testenv:lint]
deps = -r requirements/lint.txt
commands = python -m flake8 {posargs}
